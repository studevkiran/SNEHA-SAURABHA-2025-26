<!DOCTYPE html><!DOCTYPE html><!DOCTYPE html>

<html lang="en">

<head><html lang="en"><html lang="en">

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0"><head><head>

    <title>Admin - SNEHA SAURABHA 2025-26</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">    <meta charset="UTF-8">    <meta charset="UTF-8">
    <div id="tally-page" class="admin-screen active">
        <h1 class="login-header">Registration Tally</h1>
        <div style="margin-bottom: 20px; color: #D4A024; font-weight: 600;">All registrations (live data, no login required)</div>
        <div id="tally-table-container">
            <!-- Registration table will be rendered here -->
        </div>
        <button onclick="exportData('excel')" class="btn-action" style="margin-top: 30px;">üì• Export Excel</button>
    </div>

            border-radius: 10px;

            font-size: 15px;            margin-bottom: 10px;            </header>

            transition: all 0.3s;

        }            font-size: 24px;

        

        .form-group input:focus {        }            <!-- Overview Cards -->

            outline: none;

            border-color: #667eea;                    <div class="dashboard-overview">

            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);

        }        .login-card p {                <div class="stat-card">

        

        .btn-login {            color: #666;                    <div class="stat-icon">üë•</div>

            width: 100%;

            padding: 16px;            margin-bottom: 30px;                    <div class="stat-info">

            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

            color: white;        }                        <h3 id="total-registrations">0</h3>

            border: none;

            border-radius: 10px;                                <p>Total Registrations</p>

            font-size: 16px;

            font-weight: 600;        .form-group {                    </div>

            cursor: pointer;

            transition: transform 0.2s;            margin-bottom: 20px;                </div>

        }

                }                <div class="stat-card">

        .btn-login:hover {

            transform: translateY(-2px);                            <div class="stat-icon">üí∞</div>

            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);

        }        .form-group label {                    <div class="stat-info">

        

        .btn-login:active {            display: block;                        <h3 id="total-revenue">‚Çπ0</h3>

            transform: translateY(0);

        }            margin-bottom: 8px;                        <p>Total Revenue</p>

        

        .error-message {            color: #333;                    </div>

            color: #e74c3c;

            font-size: 13px;            font-weight: 500;                </div>

            margin-top: 10px;

            display: none;        }                <div class="stat-card">

            text-align: center;

        }                            <div class="stat-icon">‚úÖ</div>

        

        /* Dashboard */        .form-group input {                    <div class="stat-info">

        .dashboard {

            display: none;            width: 100%;                        <h3 id="paid-count">0</h3>

            background: #f8f9fa;

            min-height: 100vh;            padding: 12px;                        <p>Paid</p>

        }

                    border: 1px solid #ddd;                    </div>

        .navbar {

            background: white;            border-radius: 6px;                </div>

            padding: 20px 30px;

            box-shadow: 0 2px 10px rgba(0,0,0,0.08);            font-size: 14px;                <div class="stat-card">

            display: flex;

            justify-content: space-between;        }                    <div class="stat-icon">‚è≥</div>

            align-items: center;

        }                            <div class="stat-info">

        

        .navbar-brand {        .form-group input:focus {                        <h3 id="pending-count">0</h3>

            display: flex;

            align-items: center;            outline: none;                        <p>Pending</p>

            gap: 12px;

        }            border-color: #D4AF37;                    </div>

        

        .navbar-brand h2 {        }                </div>

            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

            -webkit-background-clip: text;                    </div>

            -webkit-text-fill-color: transparent;

            font-size: 20px;        .btn-primary {

            font-weight: 700;

        }            width: 100%;            <!-- Meal Summary -->

        

        .navbar-actions {            padding: 14px;            <div class="section">

            display: flex;

            gap: 15px;            background: #D4AF37;                <h3>Meal Preferences</h3>

            align-items: center;

        }            color: white;                <div class="meal-summary">

        

        .btn-refresh {            border: none;                    <div class="meal-stat veg">

            padding: 10px 20px;

            background: #f0f0f0;            border-radius: 6px;                        <span class="meal-icon">üå±</span>

            border: none;

            border-radius: 8px;            font-size: 16px;                        <span id="veg-count">0</span> Veg

            cursor: pointer;

            font-weight: 500;            font-weight: 600;                    </div>

            transition: all 0.2s;

        }            cursor: pointer;                    <div class="meal-stat non-veg">

        

        .btn-refresh:hover {            transition: all 0.3s;                        <span class="meal-icon">üçó</span>

            background: #e0e0e0;

        }        }                        <span id="non-veg-count">0</span> Non-Veg

        

        .btn-logout {                            </div>

            padding: 10px 24px;

            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);        .btn-primary:hover {                    <div class="meal-stat jain">

            color: white;

            border: none;            background: #B8960C;                        <span class="meal-icon">üçÉ</span>

            border-radius: 8px;

            cursor: pointer;        }                        <span id="jain-count">0</span> Jain

            font-weight: 600;

            transition: transform 0.2s;                            </div>

        }

                .error-msg {                </div>

        .btn-logout:hover {

            transform: translateY(-2px);            color: #e74c3c;            </div>

            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);

        }            font-size: 14px;

        

        .dashboard-content {            margin-top: 10px;            <!-- Filters and Actions -->

            padding: 30px;

            max-width: 1400px;            display: none;            <div class="section">

            margin: 0 auto;

        }        }                <div class="section-header">

        

        .stats-grid {                            <h3>Registrations</h3>

            display: grid;

            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));        /* Dashboard */                    <div class="actions">

            gap: 24px;

            margin-bottom: 30px;        .dashboard {                        <button onclick="showManualEntry()" class="btn-action">+ Manual Entry</button>

        }

                    display: none;                        <button onclick="loadRegistrations()" class="btn-action">üîÑ Refresh</button>

        .stat-card {

            background: white;        }                        <button onclick="exportData('csv')" class="btn-action">üìä Export CSV</button>

            padding: 30px;

            border-radius: 16px;                                <button onclick="exportData('excel')" class="btn-action">üìó Export Excel</button>

            box-shadow: 0 4px 15px rgba(0,0,0,0.06);

            transition: transform 0.2s;        .dashboard-header {                    </div>

            position: relative;

            overflow: hidden;            background: white;                </div>

        }

                    padding: 20px 30px;

        .stat-card:hover {

            transform: translateY(-4px);            box-shadow: 0 2px 8px rgba(0,0,0,0.1);                <!-- Filters -->

            box-shadow: 0 8px 25px rgba(0,0,0,0.1);

        }            display: flex;                <div class="filters">

        

        .stat-card::before {            justify-content: space-between;                    <select id="filter-type" onchange="filterRegistrations()">

            content: '';

            position: absolute;            align-items: center;                        <option value="">All Types</option>

            top: 0;

            left: 0;        }                        <!-- Options will be populated dynamically from registration types -->

            right: 0;

            height: 4px;                            </select>

            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);

        }        .dashboard-header h2 {                    <select id="filter-payment" onchange="filterRegistrations()">

        

        .stat-icon {            color: #D4AF37;                        <option value="">All Payment Status</option>

            font-size: 36px;

            margin-bottom: 12px;            font-size: 24px;                        <option value="completed">Paid</option>

        }

                }                        <option value="pending">Pending</option>

        .stat-value {

            font-size: 36px;                                <option value="failed">Failed</option>

            font-weight: 700;

            color: #333;        .btn-logout {                    </select>

            margin-bottom: 8px;

        }            padding: 10px 20px;                    <select id="filter-meal" onchange="filterRegistrations()">

        

        .stat-label {            background: #e74c3c;                        <option value="">All Meals</option>

            color: #777;

            font-size: 14px;            color: white;                        <option value="Veg">Veg</option>

            font-weight: 500;

            text-transform: uppercase;            border: none;                        <option value="Non-Veg">Non-Veg</option>

            letter-spacing: 0.5px;

        }            border-radius: 6px;                        <option value="Jain">Jain</option>

        

        .table-section {            cursor: pointer;                    </select>

            background: white;

            border-radius: 16px;            font-weight: 600;                    <input type="text" id="search-box" placeholder="Search by name, mobile, email..." onkeyup="searchRegistrations()">

            padding: 30px;

            box-shadow: 0 4px 15px rgba(0,0,0,0.06);        }                </div>

        }

                

        .table-header {

            display: flex;        .btn-logout:hover {                <!-- Registrations Table -->

            justify-content: space-between;

            align-items: center;            background: #c0392b;                <div class="table-container">

            margin-bottom: 25px;

        }        }                    <table id="registrations-table">

        

        .table-header h3 {                                <thead>

            font-size: 20px;

            font-weight: 700;        .dashboard-content {                            <tr>

            color: #333;

        }            padding: 30px;                                <th onclick="sortTable('id')" style="cursor: pointer;">ID ‚Üï</th>

        

        .search-box {            max-width: 1400px;                                <th onclick="sortTable('name')" style="cursor: pointer;">Name ‚Üï</th>

            padding: 10px 16px;

            border: 2px solid #e0e0e0;            margin: 0 auto;                                <th onclick="sortTable('mobile')" style="cursor: pointer;">Mobile ‚Üï</th>

            border-radius: 8px;

            width: 300px;        }                                <th>Email</th>

            font-size: 14px;

        }                                        <th onclick="sortTable('type')" style="cursor: pointer;">Type ‚Üï</th>

        

        .search-box:focus {        .stats-grid {                                <th onclick="sortTable('price')" style="cursor: pointer;">Amount ‚Üï</th>

            outline: none;

            border-color: #667eea;            display: grid;                                <th>Payment Status</th>

        }

                    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));                                <th onclick="sortTable('date')" style="cursor: pointer;">Date ‚Üï</th>

        .table-container {

            overflow-x: auto;            gap: 20px;                            </tr>

        }

                    margin-bottom: 30px;                        </thead>

        table {

            width: 100%;        }                        <tbody id="registrations-tbody">

            border-collapse: collapse;

        }                                    <!-- Populated dynamically -->

        

        thead {        .stat-card {                        </tbody>

            background: #f8f9fa;

        }            background: white;                    </table>

        

        th {            padding: 25px;                </div>

            text-align: left;

            padding: 16px;            border-radius: 12px;            </div>

            font-weight: 600;

            color: #555;            box-shadow: 0 2px 8px rgba(0,0,0,0.08);        </div>

            font-size: 13px;

            text-transform: uppercase;        }

            letter-spacing: 0.5px;

        }                <!-- Manual Entry Modal -->

        

        td {        .stat-card h3 {        <div id="manual-entry-modal" class="modal">

            padding: 16px;

            border-bottom: 1px solid #f0f0f0;            font-size: 32px;            <div class="modal-content">

            color: #333;

            font-size: 14px;            color: #D4AF37;                <h2>Manual Registration Entry</h2>

        }

                    margin-bottom: 8px;                <p class="note">Use this for walk-in registrations or corrections</p>

        tbody tr {

            transition: background 0.2s;        }                <!-- Similar form as main registration -->

        }

                                <button onclick="closeManualEntry()" class="btn-secondary">Close</button>

        tbody tr:hover {

            background: #f8f9fa;        .stat-card p {            </div>

        }

                    color: #666;        </div>

        .badge {

            padding: 6px 12px;            font-size: 14px;    </div>

            border-radius: 20px;

            font-size: 12px;        }

            font-weight: 600;

            display: inline-block;            <script src="../scripts/admin.js?v=20251108"></script>

        }

                .registrations-section {</body>

        .badge-success {

            background: #d4edda;            background: white;</html>

            color: #155724;

        }            border-radius: 12px;

                    padding: 25px;

        .badge-warning {            box-shadow: 0 2px 8px rgba(0,0,0,0.08);

            background: #fff3cd;        }

            color: #856404;        

        }        .registrations-section h3 {

                    color: #333;

        .loading-spinner {            margin-bottom: 20px;

            text-align: center;            font-size: 20px;

            padding: 60px;        }

            color: #999;        

        }        .table-container {

                    overflow-x: auto;

        .spinner {        }

            border: 3px solid #f3f3f3;        

            border-top: 3px solid #667eea;        table {

            border-radius: 50%;            width: 100%;

            width: 40px;            border-collapse: collapse;

            height: 40px;        }

            animation: spin 1s linear infinite;        

            margin: 0 auto 20px;        thead {

        }            background: #f8f9fa;

                }

        @keyframes spin {        

            0% { transform: rotate(0deg); }        th {

            100% { transform: rotate(360deg); }            text-align: left;

        }            padding: 12px;

                    font-weight: 600;

        .empty-state {            color: #555;

            text-align: center;            border-bottom: 2px solid #e9ecef;

            padding: 60px;        }

            color: #999;        

        }        td {

                    padding: 12px;

        .empty-state-icon {            border-bottom: 1px solid #e9ecef;

            font-size: 48px;            color: #333;

            margin-bottom: 16px;        }

        }        

                tbody tr:hover {

        .hidden {            background: #f8f9fa;

            display: none !important;        }

        }        

                .status-paid {

        @media (max-width: 768px) {            color: #27ae60;

            .navbar {            font-weight: 600;

                flex-direction: column;        }

                gap: 15px;        

            }        .status-pending {

                        color: #f39c12;

            .stats-grid {            font-weight: 600;

                grid-template-columns: 1fr;        }

            }        

                    .loading {

            .search-box {            text-align: center;

                width: 100%;            padding: 40px;

            }            color: #999;

                    }

            .table-header {        

                flex-direction: column;        .hidden {

                gap: 15px;            display: none;

                align-items: stretch;        }

            }    </style>

        }</head>

    </style><body>

</head>    <!-- Login Screen -->

<body>    <div id="login-screen" class="login-container">

    <!-- Login Screen -->        <div class="login-card">

    <div id="login-screen" class="login-container">            <h1>Admin Dashboard</h1>

        <div class="login-box">            <p>SNEHA SAURABHA 2025-26</p>

            <div class="login-header">            <form id="login-form">

                <h1>üéØ Admin Portal</h1>                <div class="form-group">

                <p>SNEHA SAURABHA 2025-26</p>                    <label for="username">Username</label>

            </div>                    <input type="text" id="username" required autocomplete="username">

            <form id="login-form">                </div>

                <div class="form-group">                <div class="form-group">

                    <label for="username">Username</label>                    <label for="password">Password</label>

                    <input type="text" id="username" required autocomplete="username" placeholder="Enter username">                    <input type="password" id="password" required autocomplete="current-password">

                </div>                </div>

                <div class="form-group">                <button type="submit" class="btn-primary">Login</button>

                    <label for="password">Password</label>                <div id="login-error" class="error-msg"></div>

                    <input type="password" id="password" required autocomplete="current-password" placeholder="Enter password">            </form>

                </div>        </div>

                <button type="submit" class="btn-login">Sign In</button>    </div>

                <div id="error-msg" class="error-message"></div>

            </form>    <!-- Dashboard -->

        </div>    <div id="dashboard-screen" class="dashboard">

    </div>        <header class="dashboard-header">

            <h2>üìä Dashboard</h2>

    <!-- Dashboard -->            <button id="logout-btn" class="btn-logout">Logout</button>

    <div id="dashboard-screen" class="dashboard hidden">        </header>

        <nav class="navbar">        

            <div class="navbar-brand">        <div class="dashboard-content">

                <h2>üìä Admin Dashboard</h2>            <!-- Stats -->

            </div>            <div class="stats-grid">

            <div class="navbar-actions">                <div class="stat-card">

                <button class="btn-refresh" onclick="refreshData()">üîÑ Refresh</button>                    <h3 id="total-registrations">0</h3>

                <button class="btn-logout" onclick="logout()">Logout</button>                    <p>Total Registrations</p>

            </div>                </div>

        </nav>                <div class="stat-card">

                            <h3 id="total-revenue">‚Çπ0</h3>

        <div class="dashboard-content">                    <p>Total Revenue</p>

            <!-- Stats Cards -->                </div>

            <div class="stats-grid">                <div class="stat-card">

                <div class="stat-card">                    <h3 id="paid-count">0</h3>

                    <div class="stat-icon">üë•</div>                    <p>Paid Registrations</p>

                    <div class="stat-value" id="total-count">0</div>                </div>

                    <div class="stat-label">Total Registrations</div>                <div class="stat-card">

                </div>                    <h3 id="pending-count">0</h3>

                <div class="stat-card">                    <p>Pending Payments</p>

                    <div class="stat-icon">üí∞</div>                </div>

                    <div class="stat-value" id="revenue-total">‚Çπ0</div>            </div>

                    <div class="stat-label">Total Revenue</div>

                </div>            <!-- Registrations Table -->

                <div class="stat-card">            <div class="registrations-section">

                    <div class="stat-icon">‚úÖ</div>                <h3>Recent Registrations</h3>

                    <div class="stat-value" id="paid-count">0</div>                <div class="table-container">

                    <div class="stat-label">Paid</div>                    <table>

                </div>                        <thead>

                <div class="stat-card">                            <tr>

                    <div class="stat-icon">‚è≥</div>                                <th>ID</th>

                    <div class="stat-value" id="pending-count">0</div>                                <th>Name</th>

                    <div class="stat-label">Pending</div>                                <th>Mobile</th>

                </div>                                <th>Type</th>

            </div>                                <th>Amount</th>

                                <th>Status</th>

            <!-- Registrations Table -->                                <th>Date</th>

            <div class="table-section">                            </tr>

                <div class="table-header">                        </thead>

                    <h3>All Registrations</h3>                        <tbody id="registrations-table">

                    <input type="text" class="search-box" id="search-input" placeholder="üîç Search by name, mobile, or ID...">                            <tr>

                </div>                                <td colspan="7" class="loading">Loading registrations...</td>

                <div class="table-container">                            </tr>

                    <table>                        </tbody>

                        <thead>                    </table>

                            <tr>                </div>

                                <th>ID</th>            </div>

                                <th>Name</th>        </div>

                                <th>Mobile</th>    </div>

                                <th>Club</th>

                                <th>Type</th>    <script>

                                <th>Amount</th>        const API_BASE = window.location.origin;

                                <th>Status</th>        

                                <th>Date</th>        // Login

                            </tr>        document.getElementById('login-form').addEventListener('submit', async (e) => {

                        </thead>            e.preventDefault();

                        <tbody id="registrations-body">            const username = document.getElementById('username').value;

                            <tr>            const password = document.getElementById('password').value;

                                <td colspan="8" class="loading-spinner">            const errorEl = document.getElementById('login-error');

                                    <div class="spinner"></div>            

                                    <div>Loading registrations...</div>            try {

                                </td>                const response = await fetch(`${API_BASE}/api/admin/login`, {

                            </tr>                    method: 'POST',

                        </tbody>                    headers: { 'Content-Type': 'application/json' },

                    </table>                    body: JSON.stringify({ username, password })

                </div>                });

            </div>                

        </div>                const data = await response.json();

    </div>                

                if (data.success) {

    <script>                    sessionStorage.setItem('adminAuth', 'true');

        const API_BASE = window.location.origin;                    document.getElementById('login-screen').classList.add('hidden');

        let allRegistrations = [];                    document.getElementById('dashboard-screen').style.display = 'block';

        let isAuthenticated = false;                    loadDashboardData();

                } else {

        // Check authentication on load                    errorEl.textContent = 'Invalid credentials';

        window.addEventListener('load', () => {                    errorEl.style.display = 'block';

            const authToken = sessionStorage.getItem('adminToken');                }

            if (authToken && authToken === 'authenticated') {            } catch (error) {

                showDashboard();                errorEl.textContent = 'Login failed. Please try again.';

            }                errorEl.style.display = 'block';

        });            }

        });

        // Login Handler        

        document.getElementById('login-form').addEventListener('submit', async (e) => {        // Logout

            e.preventDefault();        document.getElementById('logout-btn').addEventListener('click', () => {

            const username = document.getElementById('username').value.trim();            sessionStorage.removeItem('adminAuth');

            const password = document.getElementById('password').value;            document.getElementById('dashboard-screen').style.display = 'none';

            const errorMsg = document.getElementById('error-msg');            document.getElementById('login-screen').classList.remove('hidden');

            document.getElementById('username').value = '';

            try {            document.getElementById('password').value = '';

                const response = await fetch(`${API_BASE}/api/admin/login`, {        });

                    method: 'POST',        

                    headers: { 'Content-Type': 'application/json' },        // Load Dashboard Data

                    body: JSON.stringify({ username, password })        async function loadDashboardData() {

                });            try {

                // Load stats

                const data = await response.json();                const statsResponse = await fetch(`${API_BASE}/api/registrations/stats`);

                const stats = await statsResponse.json();

                if (data.success) {                

                    sessionStorage.setItem('adminToken', 'authenticated');                if (stats.success) {

                    isAuthenticated = true;                    document.getElementById('total-registrations').textContent = stats.data.totalRegistrations || 0;

                    showDashboard();                    document.getElementById('total-revenue').textContent = `‚Çπ${(stats.data.totalRevenue || 0).toLocaleString('en-IN')}`;

                } else {                    document.getElementById('paid-count').textContent = stats.data.paidRegistrations || 0;

                    showError('Invalid credentials. Please try again.');                    document.getElementById('pending-count').textContent = stats.data.pendingRegistrations || 0;

                }                }

            } catch (error) {                

                showError('Login failed. Please check your connection.');                // Load registrations

            }                const regsResponse = await fetch(`${API_BASE}/api/registrations/list`);

        });                const regs = await regsResponse.json();

                

        function showError(message) {                if (regs.success) {

            const errorMsg = document.getElementById('error-msg');                    displayRegistrations(regs.data.registrations || []);

            errorMsg.textContent = message;                }

            errorMsg.style.display = 'block';            } catch (error) {

            setTimeout(() => {                console.error('Failed to load dashboard data:', error);

                errorMsg.style.display = 'none';                document.getElementById('registrations-table').innerHTML = 

            }, 3000);                    '<tr><td colspan="7" style="color: #e74c3c;">Failed to load data</td></tr>';

        }            }

        }

        function showDashboard() {        

            document.getElementById('login-screen').classList.add('hidden');        // Display Registrations

            document.getElementById('dashboard-screen').classList.remove('hidden');        function displayRegistrations(registrations) {

            loadData();            const tbody = document.getElementById('registrations-table');

        }            

            if (registrations.length === 0) {

        function logout() {                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #999;">No registrations yet</td></tr>';

            sessionStorage.removeItem('adminToken');                return;

            isAuthenticated = false;            }

            document.getElementById('dashboard-screen').classList.add('hidden');            

            document.getElementById('login-screen').classList.remove('hidden');            tbody.innerHTML = registrations.map(reg => `

            document.getElementById('username').value = '';                <tr>

            document.getElementById('password').value = '';                    <td>${reg.registration_id}</td>

        }                    <td>${reg.name}</td>

                    <td>${reg.mobile}</td>

        async function loadData() {                    <td>${reg.registration_type}</td>

            try {                    <td>‚Çπ${(reg.registration_amount || 0).toLocaleString('en-IN')}</td>

                // Load stats                    <td class="${reg.payment_status === 'Paid' ? 'status-paid' : 'status-pending'}">

                const statsRes = await fetch(`${API_BASE}/api/registrations/stats`);                        ${reg.payment_status}

                const stats = await statsRes.json();                    </td>

                    <td>${new Date(reg.created_at).toLocaleDateString('en-IN')}</td>

                if (stats.success) {                </tr>

                    document.getElementById('total-count').textContent = stats.data.totalRegistrations || 0;            `).join('');

                    document.getElementById('revenue-total').textContent = `‚Çπ${(stats.data.totalRevenue || 0).toLocaleString('en-IN')}`;        }

                    document.getElementById('paid-count').textContent = stats.data.paidRegistrations || 0;        

                    document.getElementById('pending-count').textContent = stats.data.pendingRegistrations || 0;        // Auto-login if session exists

                }        if (sessionStorage.getItem('adminAuth') === 'true') {

            document.getElementById('login-screen').classList.add('hidden');

                // Load registrations            document.getElementById('dashboard-screen').style.display = 'block';

                const regsRes = await fetch(`${API_BASE}/api/registrations/list`);            loadDashboardData();

                const regs = await regsRes.json();        }

    </script>

                if (regs.success && regs.data) {</body>

                    allRegistrations = regs.data.registrations || [];</html>

                    displayRegistrations(allRegistrations);
                }
            } catch (error) {
                console.error('Failed to load data:', error);
                document.getElementById('registrations-body').innerHTML = `
                    <tr><td colspan="8" class="empty-state">
                        <div class="empty-state-icon">‚ö†Ô∏è</div>
                        <div>Failed to load data. Please refresh.</div>
                    </td></tr>
                `;
            }
        }

        function displayRegistrations(registrations) {
            const tbody = document.getElementById('registrations-body');

            if (registrations.length === 0) {
                tbody.innerHTML = `
                    <tr><td colspan="8" class="empty-state">
                        <div class="empty-state-icon">üìã</div>
                        <div>No registrations found</div>
                    </td></tr>
                `;
                return;
            }

            tbody.innerHTML = registrations.map(reg => `
                <tr>
                    <td><strong>${reg.registration_id}</strong></td>
                    <td>${reg.name}</td>
                    <td>${reg.mobile}</td>
                    <td>${reg.club || 'N/A'}</td>
                    <td>${reg.registration_type}</td>
                    <td><strong>‚Çπ${(reg.registration_amount || 0).toLocaleString('en-IN')}</strong></td>
                    <td>
                        <span class="badge ${reg.payment_status === 'Paid' ? 'badge-success' : 'badge-warning'}">
                            ${reg.payment_status || 'Pending'}
                        </span>
                    </td>
                    <td>${new Date(reg.created_at).toLocaleDateString('en-IN', {
                        day: '2-digit',
                        month: 'short',
                        year: 'numeric'
                    })}</td>
                </tr>
            `).join('');
        }

        // Search functionality
        document.getElementById('search-input').addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const filtered = allRegistrations.filter(reg =>
                reg.name.toLowerCase().includes(searchTerm) ||
                reg.mobile.includes(searchTerm) ||
                reg.registration_id.toLowerCase().includes(searchTerm) ||
                (reg.club && reg.club.toLowerCase().includes(searchTerm))
            );
            displayRegistrations(filtered);
        });

        function refreshData() {
            document.getElementById('registrations-body').innerHTML = `
                <tr><td colspan="8" class="loading-spinner">
                    <div class="spinner"></div>
                    <div>Refreshing data...</div>
                </td></tr>
            `;
            loadData();
        }
    </script>
</body>
</html>
